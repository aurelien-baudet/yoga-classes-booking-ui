<ion-header>
  <ion-toolbar>
    <ion-menu-button></ion-menu-button>
    <ion-title>Les prochains cours de Yoga</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content [class.loading]="loading">
  <ion-refresher slot="fixed" (ionRefresh)="manualRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <p *ngIf="classes && classes.length === 0">Pas de cours programmé prochainement</p>
  <app-classes 
    *ngIf="classes"
    (click)="lastClick = $event"
    [classes]="classes"
    [bookingStateProvider]="bookingStateProvider"
    [detailsStateProvider]="detailsProvider"
    [pendingStateProvider]="pendingProvider"
    [manageClassStateProvider]="manageClassStateProvider"
    [searchFriendProvider]="searchFriendProvider"
    (book)="book($event)"
    (unbook)="unbook($event)"
    (viewDetails)="detailsProvider.viewDetails($event)"
    (hideDetails)="detailsProvider.hideDetails($event)"
    (showPlaceDetails)="showPlaceDetails($event)"
    (showClassDetails)="showClassDetails($event)"
    (showApprovedStudents)="showApprovedStudents($event)"
    (showWaitingStudents)="showWaitingStudents($event)"
    (bookForFriend)="bookForFriend($event)"
    (unbookForFriend)="unbookForFriend($event)"></app-classes>
</ion-content>



<ng-template #placeDetails let-place="place">
  <app-place-details [place]="place"></app-place-details>
</ng-template>


<ng-template #approvedStudents
  let-approvedBookings="scheduledClass.bookings.approved"
  let-maxStudents="scheduledClass.lesson.maxStudents">
  <app-approved-students 
    [approvedBookings]="approvedBookings" 
    [maxStudents]="maxStudents"
    (unbook)="unbookForFriend($event)"></app-approved-students>
</ng-template>

<ng-template #waitingStudents
  let-waitingBookings="scheduledClass.bookings.waiting">
  <app-waiting-students
    [waitingBookings]="waitingBookings"
    (unbook)="unbookForFriend($event)"></app-waiting-students>
</ng-template>
  
<ng-template #approvedNotification let-bookedClass="bookedClass">
  <div class="header">
    <span class="title">Inscription confirmée</span>
  </div>
  <div class="content">
    <p>Tu es inscrit au cours du <strong>{{ bookedClass | dateRange }}</strong></p>
    <ion-button *ngIf="isMobileApp()" (click)="addToCalendar(bookedClass)" size="small">ajouter au calendrier</ion-button>
  </div>
</ng-template>

<ng-template #waitingListNotification let-bookedClass="bookedClass">
  <div class="header">
    <span class="title">Inscription en file d'attente</span>
  </div>
  <div class="content">
    <p>Tu es sur liste d'attente pour le cours du <strong>{{ bookedClass | dateRange }}</strong>.<br />
      Tu recevras une notification lorsqu'une place se libèrera.</p>
  </div>
</ng-template>

<ng-template #unbookedNotification let-bookedClass="bookedClass">
  <div class="header">
    <span classs="title">Désinscription</span>
  </div>
  <div class="content">
    <p>Tu es désinscrit du cours du <strong>{{ bookedClass | dateRange }}</strong>.</p>
    <ion-button *ngIf="isMobileApp()" (click)="removeFromCalendar(bookedClass)" size="small">retirer du calendrier</ion-button>
  </div>
</ng-template>

  
<ng-template #alreadyBookedNotification let-bookedClass="bookedClass">
  <div class="header">
    <span class="title">Déjà inscrit</span>
  </div>
  <div class="content">
    <p>Tu es déjà inscrit au cours du <strong>{{ bookedClass | dateRange }}</strong></p>
  </div>
</ng-template>
  
<ng-template #notBookedNotification let-bookedClass="bookedClass">
  <div class="header">
    <span class="title">Pas encore inscrit</span>
  </div>
  <div class="content">
    <p>Tu n'es pas inscrit au cours du <strong>{{ bookedClass | dateRange }}</strong></p>
  </div>
</ng-template>