<ion-card [class.show-details]="showDetails" 
          [class.bookable]="bookable" 
          [class.booked]="booked" 
          [class.booking-approved]="bookingApproved"
          [class.booking-waiting]="bookingWaiting"
          [class.pending]="pending"
          [class.canceled]="canceled"
          [class.editable]="editable"
          [class.cancelable]="cancelable"
          [class.place-changed]="scheduledClass.lesson.placeChanged">
  <ion-card-header>
    <ion-card-title (click)="showClassDetails.emit(scheduledClass)">{{ scheduledClass | dateRange }}</ion-card-title>
    <ion-button (click)="book.emit(scheduledClass)" *ngIf="bookable && !booked && !pending" size="small">
        <ion-icon slot="icon-only" name="custom-book"></ion-icon>
    </ion-button>
    <ion-button (click)="unbook.emit(scheduledClass)" *ngIf="bookable && booked && !pending" size="small">
        <ion-icon slot="icon-only" name="custom-unbook"></ion-icon>
    </ion-button>
    <ion-button *ngIf="bookable && pending" size="small">
        <ion-icon slot="icon-only" name="custom-pending"></ion-icon>
    </ion-button>
    <ion-button (click)="cancel.emit(scheduledClass)" *ngIf="cancelable" size="small">
        <ion-icon slot="icon-only" name="custom-cancel-class"></ion-icon>
    </ion-button>
    <ion-button (click)="edit.emit(scheduledClass)" *ngIf="editable" size="small">
        <ion-icon slot="icon-only" name="custom-edit-class"></ion-icon>
    </ion-button>
  </ion-card-header>
  <ion-card-content>
    <div class="preview">
      <span class="title" (click)="showClassDetails.emit(scheduledClass)">{{ scheduledClass.lesson.title }}</span>
      <div class="remaining-places" (click)="showApprovedStudents.emit(scheduledClass)">
        <ion-icon slot="icon-only" name="custom-approved-list"></ion-icon>
        <ion-badge>{{ getNumberOfApprovedStudents() }}/{{ scheduledClass.lesson.maxStudents }}</ion-badge>
      </div>
      <div class="waiting-queue" (click)="showWaitingStudents.emit(scheduledClass)">
        <ion-icon slot="icon-only" name="custom-waiting-list"></ion-icon>
        <ion-badge>{{ getNumberOfWaitingStudents() }}</ion-badge>
      </div>
      <div class="place">
        <ion-button (click)="showPlaceDetails.emit(scheduledClass.lesson.place)">
          {{ scheduledClass.lesson.place.name }}
          <ion-icon slot="start" name="custom-place"></ion-icon>
        </ion-button>
        <span class="warning" *ngIf="scheduledClass.lesson.placeChanged">le lieu de dispense a été modifié</span>
      </div>
    </div>
    <div class="details">
      <ion-button (click)="viewDetails.emit(scheduledClass)" *ngIf="!showDetails" size="small">
        <ion-icon slot="icon-only" name="custom-view-details"></ion-icon>
      </ion-button>
      <ion-button (click)="hideDetails.emit(scheduledClass)" *ngIf="showDetails" size="small">
        <ion-icon slot="icon-only" name="custom-hide-details"></ion-icon>
      </ion-button>
      <app-class-details 
        [scheduledClass]="scheduledClass"
        [searchFriendProvider]="searchFriendProvider"
        (bookForFriend)="bookForFriend.emit($event)"
        (unbookForFriend)="unbookForFriend.emit($event)"></app-class-details>
    </div>
    <div class="cancel-details" *ngIf="canceled">
      <h3>Cours annulé</h3>
      <p class="lesson-canceled">Cours annulé</p>
      <p class="teacher-message">
        <span class="intro">Message de {{ scheduledClass.lesson.teacher.displayName }} :</span>
        <span class="message">{{ canceledInfo.message }}</span>
      </p>
    </div>
  </ion-card-content>
</ion-card>
  